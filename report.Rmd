---
title: "BDA - Project report"
author: "Anonymous"
output: 
  pdf_document: 
    toc: yes
    toc_depth: 3
urlcolor: blue
---

```{r, include=FALSE}
library(rstan)
library(ggplot2)
library(posterior)
library(loo)
library(patchwork)
library(dplyr)
library(reshape2)
```

First, let us import the data into its own dataframe:

```{r}
burnout <- read.csv('data/burnout.csv')
head(burnout)
```
```{r}
ggplot() + 
  geom_point(data=burnout, aes(x=fatigue_score, y=burn_rate, col=sex, alpha=0.5))
```


Let's do a bit of data analysis:

```{r, fig.width=14, fig.height=5}
df_plot <- as.data.frame(table(burnout$sex))
df_plot$Freq <- df_plot$Freq / sum(df_plot$Freq)

sex_percent <- ggplot(data=df_plot, aes(x="", y=Freq, fill=Var1))+
  geom_bar(stat='identity', width=0.5) + 
  labs(title='Percentage of Female vs Male') + 
  guides(fill=guide_legend(title='Sex')) + 
  scale_y_continuous(labels = scales::percent) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank())

df_plot <- as.data.frame(table(burnout$company_type))
df_plot$Freq <- df_plot$Freq / sum(df_plot$Freq)

company_percent <- ggplot(data=df_plot, aes(x="", y=Freq, fill=Var1))+
  geom_bar(stat='identity', width=0.5) + 
  labs(title='Percentage of Product vs Service company') +
  guides(fill=guide_legend(title='Company type')) + 
  scale_y_continuous(labels = scales::percent) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank())

df_plot <- as.data.frame(table(burnout$wfh))
df_plot$Freq <- df_plot$Freq / sum(df_plot$Freq)

wfh_percent <- ggplot(data=df_plot, aes(x="", y=Freq, fill=Var1))+
  geom_bar(stat='identity', width=0.5) + 
  labs(title='Percentage of Cannot work remotely vs Can work remotely') +
  guides(fill=guide_legend(title='Work from home set up')) + 
  scale_y_continuous(labels = scales::percent) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank())


sex_percent + company_percent + wfh_percent
```

```{r}
df_cor <- data.frame(burnout$designation, burnout$work_hours, burnout$fatigue_score)
names(df_cor) <- gsub("burnout.", "", names(df_cor))
df_cor <- round(cor(df_cor), 2)
df_cor <- melt(df_cor)
ggplot(data=df_cor, aes(x=Var1, y=Var2, fill=value)) + 
  geom_tile() + 
  geom_text(aes(Var2, Var1, label = value),
          color = "white", size = 4)
```
Most of the correlations are very high, so if we use all of them, we will have the problem of multicolinearity


To means for teh effect of covariates. Define index ==1 if it is male and == 0 it is female. Depends on the observation, it will be relay to the correct mean.
In brms there is an option to build a Stan code. Use brms to define problem and auto Stan